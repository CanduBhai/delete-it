#!/bin/bash

BASE_DIR="values"
REMOVE_KEYS=("cuat11" "prod12")

# Build regex pattern from keys
pattern=$(printf "%s" "${REMOVE_KEYS[@]}" | sed 's/ /|/g')

# Loop through all z3.values.yaml files in all subdirectories
find "$BASE_DIR" -type f -name "z3.values.yaml" | while read -r file; do
  echo "ðŸ§¹ Cleaning $file"

  # Remove lines with matching keys (e.g., cuat11: or prod12:)
  grep -vE "^[[:space:]]*(${pattern}):" "$file" > "$file.tmp" && mv "$file.tmp" "$file"
done

echo "âœ… Done! Removed lines with keys: ${REMOVE_KEYS[*]}"
