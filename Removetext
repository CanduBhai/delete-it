#!/bin/bash

# Root directory
BASE_DIR="values"

# Keys to remove
REMOVE_KEYS=("cuat11" "prod12")

# Combine keys into one regex pattern
pattern=$(IFS="|"; echo "${REMOVE_KEYS[*]}")

# Find and process all z3.values.yaml files
find "$BASE_DIR" -type f -name "z3.values.yaml" | while read -r file; do
  echo "ðŸ§¹ Cleaning $file"

  # Remove lines that begin with optional spaces and contain the keys followed by colon
  awk -v pattern="^ *(${pattern}):" '!($0 ~ pattern)' "$file" > "$file.tmp" && mv "$file.tmp" "$file"
done

echo "âœ… Done! Removed entries for: ${REMOVE_KEYS[*]}"
