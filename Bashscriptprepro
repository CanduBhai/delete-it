#!/bin/bash

# Set base directory
BASE_DIR="values"

# Loop through all z3.values.yaml files
find "$BASE_DIR" -type f -name "z3.values.yaml" | while read -r file; do
  echo "Processing: $file"

  # Use awk to duplicate cuat11 to cuat12 for each key block
  awk '
    /^[^[:space:]]/ { section = $0 } # Remember current top-level key
    /^\s+cuat11:/ {
      print
      sub("cuat11", "cuat12", $0)
      print
      next
    }
    { print }
  ' "$file" > "$file.tmp" && mv "$file.tmp" "$file"
done

echo "All files updated."
